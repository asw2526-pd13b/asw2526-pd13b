<%= form_with(model: post, local: true, html: { multipart: true, class: "Form" }) do |form| %>
  <% if post.errors.any? %>
    <div class="Flash alert">
      <div style="font-weight:800;margin-bottom:6px;">
        <%= pluralize(post.errors.count, "error") %> prevented this post from being saved
      </div>
      <div class="Prose">
        <ul style="margin:0;padding-left:18px;">
          <% post.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <div class="Field">
    <%= form.label :title, "Title" %>
    <%= form.text_field :title, required: true, class: "Input", placeholder: "Short, descriptive title" %>
  </div>

  <div class="Field">
    <%= form.label :url, "Link" %>
    <%= form.url_field :url, class: "Input", placeholder: "https://â€¦" %>
    <p class="Help">If you leave this empty, the post will behave like a text thread.</p>
  </div>

  <div class="Field">
    <%= form.label :body, "Body (optional)" %>
    <%= form.text_area :body, rows: 10, class: "TextArea", placeholder: "Add context, code blocks, reproduction steps, etc." %>
  </div>

  <div class="Field">
    <%= form.label :community_id, "Community" %>
    <%= form.collection_select :community_id, @communities, :id, :slug, { prompt: "Select a community" }, { class: "Input" } %>
  </div>

  <div class="Field">
    <%= form.label :image, "Image (optional)" %>
    <%= form.file_field :image, accept: "image/*", class: "Input" %>
  </div>

  <div class="Pills" style="justify-content:flex-end;">
    <%= form.submit (post.persisted? ? "Save changes" : "Create post"), class: "btn btn-primary" %>
  </div>
<% end %>
